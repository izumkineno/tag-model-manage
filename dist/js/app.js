(function(){"use strict";var e={3363:function(e,t,n){var i=n(9963),a=n(4717),o=(n(4984),n(8285),n(4408)),l=(n(5768),n(4545)),s=(n(3798),n(5064)),r=(n(4157),n(3378)),c=(n(7951),n(5381)),d=(n(3567),n(3176)),p=(n(1433),n(7583)),u=(n(8288),n(6252)),g=n(2262),h=n(3577),m=n(7720),f=n(1348);const y=(0,m.Q_)("config",{persist:!0,state:()=>({info:{prompt:{name:"提示词",expansion:!0,type:"prompt"},promptNeg:{name:"反向提示词",expansion:!0,type:"promptNeg"},todo:{name:"待选/草稿栏",expansion:!1,type:"todo"}},sym:[["(",")"],["[","]"],["{","}"]],switch:{autoStart:{name:"自动开始",active:!1},table:!1},gradioConfigItems:["txt2img_sampling","txt2img_steps","txt2img_height","txt2img_width","txt2img_batch_count","txt2img_batch_size","txt2img_cfg_scale","txt2img_restore_faces"],gradioConfig:{}}),actions:{GradioConfig(e){try{gradio_config.components.forEach((t=>{this.gradioConfigItems.forEach((n=>{n===t.props.elem_id&&(e?"undefined"!==typeof this.gradioConfig[n]&&(t.props.value=this.gradioConfig[n]):this.gradioConfig[n]=t.props.value)}))})),f.z8.success("读取/保存配置成功："+this.gradioConfig.toString())}catch(t){f.z8.error("读取/保存配置失败："+t)}}}});var w=n(32),_=(n(8137),n(9889)),b=(n(7555),n(3632));n(4534);const x=(0,m.Q_)("contextmenu",{persist:!1,state:()=>({showMenu:!1,showMenuGroup:!1,x:0,y:0}),getters:{menu(){const e=S(),t={1:{name:"开启/关闭",icon:"dashboard",key:"",action:()=>{e.switch(this.event,this.index,this.type)}},2:{name:"编辑",icon:"dashboard",key:"",action:()=>{e.inputFocus(this.event,this.index,"editing",this.type)}},3:{name:"权重编辑",icon:"dashboard",key:"",action:()=>{e.inputFocus(this.event,this.index,"weightEditing",this.type)}},4:{name:"复制",icon:"copy",key:"",action:()=>{e.copy(this.event,this.index,this.type)}},5:{name:"删除",icon:"dashboard",key:"",action:()=>{e.delete(this.event,this.index,this.type)}}};return t},menuGroup(){const e=S(),t={1:{name:"新建tag",icon:"new",key:"",action:()=>{e.add(this.event,this.index,this.type)}},2:{name:"新建tag组",icon:"new",key:"",action:()=>{e.add(this.event,this.index,this.type,!0)}}};return t}},actions:{contextMenuClick(e,t,n,i){this.event=e,this.index=t,this.type=n;const a=()=>{const e=setTimeout((()=>{i?this.showMenuGroup=!1:this.showMenu=!1,clearTimeout(e)}))},o=setTimeout((()=>{i?this.showMenuGroup=!0:this.showMenu=!0;const t=window.innerWidth,n=window.innerHeight,l=350,s=50*Object.keys(i?this.menuGroup:this.menu).length+50;this.x=e.clientX+l>t?t-l:e.clientX,this.y=e.clientY+s>n?n-s:e.clientY,document.addEventListener("mouseup",a,{once:!0}),clearTimeout(o)}),100)}}}),S=(0,m.Q_)("main",{persist:!0,state:()=>({prompt:[{id:"0",name:"这里创建提示词",state:{active:!1,editing:!1,weightEditing:!1},weight:0,longText:!1,children:[]}],promptNeg:[{id:"1",name:"这里创建反向提示词",state:{active:!1,editing:!1,weightEditing:!1},weight:0,longText:!1,children:[]}],todo:[],promptTab:[],promptNegTab:[],todoTab:[]}),actions:{clickHandle(e,t,n){const i=e.ctrlKey,a=e.altKey,o=["click","contextmenu"],l=(i?a?3:1:a?2:0)+4*o.indexOf(e.type),s={0:()=>this.switch(e,t,n),1:()=>this.inputFocus(e,t,"editing",n),2:()=>this.inputFocus(e,t,"weightEditing",n),3:()=>this.delete(e,t,n),4:()=>this.contextmenu(e,t,n),5:()=>this.add(e,t,n),6:()=>this.add(e,t,n,!0),7:()=>this.longTextMode()},r=s[l];r()},pos(e,t,n,i,a){const o=e.parentElement.__draggable_component__||e.__draggable_component__,l=e.__draggable_context,s=t||Array.from(o.itemKey);let r="undefined"===typeof l?s:s.concat(l.index);i&&(r=r.slice(0,r.length-1));let c=this[n];for(let d=0;d<r.length;d++){const e=r[d],t=c[e].children;"undefined"!==typeof t&&(c=t)}return i&&a&&l?c[l.index]:c},input(e,t,n,i){const a=this.pos(e.target,t,i,!0,!0);return!(!("state"in a)||!a.state)&&(a.state[n]=!a.state[n],!0)},tagModel(e){const t=""+Math.random().toString(36).slice(-8);return{id:t,longText:!1,name:e||t,state:{active:!0,editing:!0,weightEditing:!1},weight:0}},tabChange(e,t){"undefined"!==typeof t&&"undefined"===typeof t.length&&-1!==e.search("Tab")&&(this[e]=this[e].map((e=>(e.state.active=!0,e))),t.state.active=!1,"undefined"===typeof t.children&&(t.children=[]),this[e.replace("Tab","")]=t.children)},output(){const e=y(),t=(t,n)=>{const i=e.sym;let a;if(this.isLora(t))a=n;else if("undefined"!==typeof t.weightNu){const e=t.weightNu;a=`${i[0][0]}${n}:${e}${i[0][1]}`}else{let e=t.weight;if(0===e)a=n;else{const t=e>0?i[0]:i[1];e=Math.abs(e);const o=n.length;a=n.trim().padStart(o+e,t[0]).padEnd(o+2*e,t[1])}}return a},n=e=>{const i=[];return e.forEach((e=>{if(e.state.active){let a;a="undefined"===typeof e.children?t(e,e.name):t(e,n(e.children)),a.length>0&&i.push(a)}})),i.join(",")},i=n(this.prompt),a=n(this.promptNeg);try{const t=gradio_config.components;if(t){const n=[];t.forEach(((e,i)=>{if("textbox"===e.type){const a=e.props;"txt2img_prompt"===a.elem_id&&"Prompt"===a.label&&n.push(t[i]),"txt2img_neg_prompt"===a.elem_id&&"Negative prompt"===a.label&&n.push(t[i])}})),n[0].props.value=i,n[1].props.value=a,e.switch.autoStart.active&&document.querySelector("body > gradio-app").shadowRoot.querySelector("#txt2img_generate").click()}}catch(o){console.log(o)}},inputFocus(e,t,n,i){this.input(e,t,n,i)&&(0,u.Y3)((()=>{e.target&&e.target.children[0].focus()}))},switch(e,t,n){const i=this.pos(e.target,t,n,!0,!0);"state"in i&&i.state&&(i.state.active=!i.state.active),this.tabChange(n,i)},delete(e,t,n){const i="undefined"===typeof e.__draggable_context?e.target.__draggable_context:e.__draggable_context;if(i){const{index:a}=i,o=this.pos("undefined"!==typeof e.target?e.target:e,t,n,!0),l="undefined"===typeof this[n][a]||this[n][a].state.active;Array.isArray(o)?o.splice(a,1):o.children&&o.children.splice(a,1),l||0===this[n].length||this.tabChange(n,this[n][a-1]||this[n][a]),-1!==n.search("Tab")&&0===o?.length&&(this[n.replace("Tab","")]=[])}},add(e,t,n,i){const a=()=>{if(1===this[n].length){const e=this.tagModel("old");e.children=this[n.replace("Tab","")],e.state.editing=!1,e.children.length>0&&this[n].unshift(e)}},o=()=>{const t=e.target.parentNode.firstElementChild.firstElementChild.firstElementChild.firstElementChild.lastElementChild;t.firstElementChild.focus(),t.firstElementChild.select()},l=this.tagModel();i&&(l.children=[]);const s=this.pos(e.target,t,n),r=s,c=s;"undefined"!==typeof r.children?r.children.push(l):c.push(l),(0,u.Y3)((()=>{const t="undefined"!==typeof e.target.__draggable_component__,i="undefined"!==typeof e.target.__draggable_context;if(t||i){const n=e.target.lastChild.children;if(t)n[0].focus(),n[0].select();else{const t=e.target.parentElement.children,i=t[t.length-1];i.children[0].focus(),"undefined"!==typeof n&&(n[n.length-1].firstChild.focus(),n[n.length-1].firstChild.select())}}else a(),o(),this.tabChange(n,l)}))},copy(e,t,n){const i="undefined"===typeof e.__draggable_context?e.target.__draggable_context:e.__draggable_context;if(i){const{index:a}=i,o=this.pos("undefined"!==typeof e.target?e.target:e,t,n,!0);Array.isArray(o)&&o.splice(a,0,JSON.parse(JSON.stringify(o[a])))}},contextmenu(e,t,n){const i=x();void 0!==e.target.__draggable_context&&i.contextMenuClick(e,t,n),void 0!==e.target.__draggable_component__&&i.contextMenuClick(e,t,n,!0)},longTextMode(){console.log("长文本模式")},weightInput(e){e.state.weightEditing=!1;const t=e.weight.toString();"string"===typeof e.weight&&(e.weight=0),e.weight>0&&e.weight<2&&(t.length>1||1===e.weight)?(e.weightNu=e.weight,this.isLora(e)&&(e.name=e.name.replace(/:(\d|\d(\.\d{1,2}))>/g,`:${e.weightNu>=0?e.weightNu:0}>`))):(e.weightNu=void 0,e.weight=Number(e.weight.toFixed(0)))},editingInput(e){e.name=e.name.trim(),e.state.editing=!1,e.weight=this.isLora(e)?1:0},extractStrings(e,t){const n=[];let i=0,a=0,o=0,l=0,s=0;for(let r=0;r<e.length;r++)switch(e[r]){case"(":a++;break;case")":a--;break;case"[":o++;break;case"]":o--;break;case"{":l++;break;case"}":l--;break;case"<":s++;break;case">":s--;break;case t:if(0===a&&0===o&&0===l&&0===s){const t=e.slice(i,r).trim();n.push(t),i=r+1}}return n.push(e.slice(i).trim()),n},editingInputMulti(e,t,n){e.name=e.name.trim(),e.name=e.name.replace("，",","),e.name=e.name.replace("（","("),e.name=e.name.replace("）",")");const i=this.extractStrings(e.name,",");let a=this[n];for(const o of t)a&&(a=a[o].children);if(a){const t=a.indexOf(e);a.splice(t,1),this.editingInputMultiCheck(a,i)}this.editingInput(e)},editingInputMultiCheck(e,t){const n=(e,t)=>{this.isWeightNu(e.name)?this.getWeightNu(e):this.getWeight(t,e)};for(const i of t)if(i.length>0){const t=this.tagModel();if(t.state.editing=!1,t.name=i.trim(),n(t,i),i.includes(",")&&"<"!==i[0]){const e=this.extractStrings(t.name,",");e.length>1&&(t.children=[],t.name="组",this.editingInputMultiCheck(t.children,e))}this.isLora(t)&&this.getLoraWeight(t),e.push(t)}},getWeight(e,t){const n=e.match(/^(\{|\[|\(){0,}/g),i=e.match(/(\}|\]|\)){0,}$/g);if(n&&i){const a=n[0].length>i[0].length?i[0].length:n[0].length;if(e.includes("|")||-1!==e.search(/:\s?\d+(\.\d+)?]/g))return;"("===e[0]?t.weight=a:"["!==e[0]&&"{"!==e[0]||(t.weight=0-a),t.name=t.name.slice(a,t.name.length-a).trim()}},getWeightNu(e){const t=e.name.match(/:\s?\d+(\.\d+)?\)$/g),n=t?.[0];if("undefined"!==typeof n){const t=n.length>0?Number(n.slice(1,n.length-1)):0;e.weightNu=t,e.weight=t,e.name=e.name.slice(1,e.name.length-n.length)}},getLoraWeight(e){const t=e.name.match(/:\s?\d+(\.\d+)?>$/g),n=t?.[0];if("undefined"!==typeof n){const t=n.length>0?Number(n.slice(1,n.length-1)):0;e.weightNu=t,e.weight=t}},isWeightNu(e){return-1!==e.search(/:\s?\d+(\.\d+)?\)$/g)},isLora(e){return-1!==e.name.trim().search(/^<lora:.*:(\d|\d(\.\d{1,2}))>$/g)}}});var v=n(9980),k=n.n(v);const U=["onUpdate:modelValue","onBlur","onKeyup"],C=["onUpdate:modelValue","step","onBlur","onKeyup"],M={key:2,style:{display:"inline-block",visibility:"hidden"}},W={key:3};var N=(0,u.aZ)({__name:"nested-item",props:{children:null,type:null,index:null},setup(e){const t=e,n=S(),a={animation:200,group:"description",disabled:!1,ghostClass:"ghost"},o=(0,u.Fl)((()=>"undefined"===typeof t.index?[]:t.index)),l=e=>{const t=e.state.editing?"editing ":"",n=e.state.weightEditing?"weight ":"",i=e.state.active?"":"off ",a="undefined"!==typeof e.children?"group ":"";return a+i+t+n},s=e=>{const t=e=>.7*e+.3,n={};let i;if("undefined"!==typeof e.weightNu){const n=e.weightNu;i=n>=1?`rgba(0, 200, 0, ${t(n-1)}`:`rgba(200, 0, 0, ${t(1-n)})`}else{const n=e.weight;i=0===n?"":n>0?`rgba(0, 200, 0, ${t(1.1**n-1)})`:`rgba(200, 0, 0, ${t(1-1/1.1**-n)})`}return i.length>0&&(n.background=i),n};return(r,c)=>{const d=(0,u.up)("NestedItem",!0);return(0,u.wg)(),(0,u.j4)((0,g.SU)(k()),(0,u.dG)({"item-key":"undefined"===typeof t.index?"":(0,g.SU)(o).toString(),list:e.children,class:"dragArea",tag:"ul"},a,{onClick:[c[4]||(c[4]=(0,i.iM)((t=>(0,g.SU)(n).clickHandle(t,(0,g.SU)(o),e.type)),["stop","exact"])),c[5]||(c[5]=(0,i.iM)((t=>(0,g.SU)(n).clickHandle(t,(0,g.SU)(o),e.type)),["stop","exact","ctrl"])),c[6]||(c[6]=(0,i.iM)((t=>(0,g.SU)(n).clickHandle(t,(0,g.SU)(o),e.type)),["stop","exact","alt"])),c[7]||(c[7]=(0,i.iM)((t=>(0,g.SU)(n).clickHandle(t,(0,g.SU)(o),e.type)),["stop","exact","ctrl","alt"]))],onContextmenu:[c[8]||(c[8]=(0,i.iM)((t=>(0,g.SU)(n).clickHandle(t,(0,g.SU)(o),e.type)),["prevent","stop","exact"])),c[9]||(c[9]=(0,i.iM)((t=>(0,g.SU)(n).clickHandle(t,(0,g.SU)(o),e.type)),["prevent","stop","exact","ctrl"])),c[10]||(c[10]=(0,i.iM)((t=>(0,g.SU)(n).clickHandle(t,(0,g.SU)(o),e.type)),["prevent","stop","exact","alt"])),c[11]||(c[11]=(0,i.iM)((t=>(0,g.SU)(n).clickHandle(t,(0,g.SU)(o),e.type)),["prevent","stop","exact","ctrl","alt"]))]}),{item:(0,u.w5)((({element:a})=>[(0,u._)("li",{class:(0,h.C_)([l(a),"tag-frame"]),style:(0,h.j5)(s(a))},[a.state.editing?(0,u.wy)(((0,u.wg)(),(0,u.iD)("input",{key:0,"onUpdate:modelValue":e=>a.name=e,class:"tag-input",onPointerdown:c[0]||(c[0]=(0,i.iM)((()=>{}),["stop"])),onBlur:e=>(0,g.SU)(n).editingInput(a),onKeyup:(0,i.D2)((t=>(0,g.SU)(n).editingInputMulti(a,(0,g.SU)(o),e.type)),["enter"]),onClick:c[1]||(c[1]=(0,i.iM)((()=>{}),["stop"])),onContextmenu:c[2]||(c[2]=(0,i.iM)((()=>{}),["stop"]))},null,40,U)),[[i.nr,a.name]]):(0,u.kq)("",!0),a.state.weightEditing?(0,u.wy)(((0,u.wg)(),(0,u.iD)("input",{key:1,"onUpdate:modelValue":e=>a.weight=e,class:"tag-input",step:(0,g.SU)(n).isLora(a)?.1:1,max:"7",min:"-7",type:"number",onPointerdown:c[3]||(c[3]=(0,i.iM)((()=>{}),["stop"])),onBlur:e=>(0,g.SU)(n).weightInput(a),onKeyup:(0,i.D2)((e=>(0,g.SU)(n).weightInput(a)),["enter"])},null,40,C)),[[i.nr,a.weight]]):(0,u.kq)("",!0),a.state.editing?((0,u.wg)(),(0,u.iD)("div",M,(0,h.zw)(a.name+"1"),1)):((0,u.wg)(),(0,u.iD)("span",W,(0,h.zw)(a.name),1)),a.children?((0,u.wg)(),(0,u.j4)(d,{key:4,children:a.children,index:(0,g.SU)(o).concat([t.children.indexOf(a)]),type:e.type},null,8,["children","index","type"])):(0,u.kq)("",!0)],6)])),_:1},16,["item-key","list"])}}});const T=N;var z=T,E=n(591),j=(n(1362),n(5781));const O=["onUpdate:modelValue","onBlur","onKeyup"],D={key:1,style:{display:"inline-block",visibility:"hidden"}},H={key:2},I={class:"counter"};var $=(0,u.aZ)({__name:"nested-tab",props:{children:null,type:null,index:null},setup(e){const t=e,n=S(),a=(0,g.qj)({animation:200,group:"description",disabled:!1,ghostClass:"ghost-tab"}),l=(0,u.Fl)((()=>"undefined"===typeof t.index?[]:t.index)),s=e=>{const t=e.state.editing?"editing ":"",n=e.state.weightEditing?"weight ":"",i=e.state.active?"":"on ",a="undefined"!==typeof e.children?"group ":"";return a+i+t+n};let r;const c=e=>{r=e},d=(e,t)=>{n.delete(r.target.parentElement,e,t)};return(0,u.bv)((()=>{const e=t.children.filter((e=>!e.state.active))[0];n.tabChange(t.type,e)})),(r,m)=>{const f=p.mi,y=E.i1,w=o.Mr,_=b.dq;return(0,u.wg)(),(0,u.j4)(_,{style:{"align-items":"center"},justify:"space-between"},{default:(0,u.w5)((()=>[(0,u.Wm)(w,{class:"card-tab-scroll-container"},{default:(0,u.w5)((()=>[(0,u.Wm)((0,g.SU)(k()),(0,u.dG)({"item-key":"undefined"===typeof t.index?"":(0,g.SU)(l).toString(),list:e.children,class:"card-tab",filter:".on",tag:"ul"},a,{onDblclick:m[4]||(m[4]=t=>(0,g.SU)(n).inputFocus(t,(0,g.SU)(l),"editing",e.type)),onClick:[m[5]||(m[5]=(0,i.iM)((t=>(0,g.SU)(n).clickHandle(t,(0,g.SU)(l),e.type)),["stop","exact"])),m[6]||(m[6]=(0,i.iM)((t=>(0,g.SU)(n).clickHandle(t,(0,g.SU)(l),e.type)),["stop","exact","ctrl"])),m[7]||(m[7]=(0,i.iM)((t=>(0,g.SU)(n).clickHandle(t,(0,g.SU)(l),e.type)),["stop","exact","ctrl","alt"]))]}),{item:(0,u.w5)((({element:t})=>[(0,u._)("li",{style:{"flex-wrap":"inherit"},class:(0,h.C_)([s(t),"tag-frame"])},[t.state.editing?(0,u.wy)(((0,u.wg)(),(0,u.iD)("input",{key:0,"onUpdate:modelValue":e=>t.name=e,class:"tag-input",onPointerdown:m[0]||(m[0]=(0,i.iM)((()=>{}),["stop"])),onBlur:e=>(0,g.SU)(n).editingInput(t),onKeyup:(0,i.D2)((i=>(0,g.SU)(n).editingInputMulti(t,(0,g.SU)(l),e.type)),["enter"]),onClick:m[1]||(m[1]=(0,i.iM)((()=>{}),["stop"])),onContextmenu:m[2]||(m[2]=(0,i.iM)((()=>{}),["stop"]))},null,40,O)),[[i.nr,t.name]]):(0,u.kq)("",!0),t.state.editing?((0,u.wg)(),(0,u.iD)("div",D,(0,h.zw)(t.name+"1"),1)):((0,u.wg)(),(0,u.iD)("span",H,(0,h.zw)(t.name),1)),(0,u.Wm)(y,{title:"确认删除?",onConfirm:m[3]||(m[3]=t=>d((0,g.SU)(l),e.type))},{reference:(0,u.w5)((()=>[t.state.editing?(0,u.kq)("",!0):((0,u.wg)(),(0,u.j4)(f,{key:0,circle:"",size:"small",style:{"margin-left":"3px",width:"1rem",height:"1rem",border:"0"},icon:(0,g.SU)(j.x8P),onClick:c},null,8,["icon"]))])),_:2},1024)],2)])),_:1},16,["item-key","list"])])),_:1}),(0,u.Wm)(f,{circle:"",icon:(0,g.SU)(j.v37),class:"tab-add",onClick:m[8]||(m[8]=t=>(0,g.SU)(n).add(t,(0,g.SU)(l),e.type))},null,8,["icon"]),(0,u._)("span",I,(0,h.zw)((0,g.SU)(n)[e.type].length),1)])),_:1})}}});const V=$;var K=V,L=(0,u.aZ)({__name:"nested-card",props:{type:null},setup(e){const t=S(),n=y();return(a,o)=>{const l=c.OX,s=b.dq,r=_.os,d=w.Kf;return(0,u.wg)(),(0,u.j4)(d,{onContextmenu:o[1]||(o[1]=(0,i.iM)((()=>{}),["prevent"])),"body-style":(0,g.SU)(n).info[e.type].expansion?"":{display:"none"}},{header:(0,u.w5)((()=>[(0,u.Wm)(s,{align:"middle",class:"row-bg",justify:"space-between"},{default:(0,u.w5)((()=>[(0,u._)("div",null,(0,h.zw)((0,g.SU)(n).info[e.type].name),1),(0,u.Wm)(l,{modelValue:(0,g.SU)(n).info[e.type].expansion,"onUpdate:modelValue":o[0]||(o[0]=t=>(0,g.SU)(n).info[e.type].expansion=t),"inline-prompt":""},null,8,["modelValue"])])),_:1})])),default:(0,u.w5)((()=>[(0,u.Wm)(K,{children:(0,g.SU)(t)[e.type+"Tab"],type:e.type+"Tab"},null,8,["children","type"]),(0,u.Wm)(r),(0,u.Wm)(z,{children:(0,g.SU)(t)[e.type],type:e.type},null,8,["children","type"])])),_:1},8,["body-style"])}}});const q=L;var F=q;const G=["onClick"],A=["onClick"];var Z=(0,u.aZ)({__name:"contextmenu-view",setup(e){const t=x(),n=e=>{e.action(),t.showMenu=!1},i=e=>{e.action(),t.showMenuGroup=!1};return(e,a)=>((0,u.wg)(),(0,u.iD)(u.HY,null,[(0,g.SU)(t).showMenu?((0,u.wg)(),(0,u.iD)("div",{key:0,style:(0,h.j5)({top:`${(0,g.SU)(t).y}px`,left:`${(0,g.SU)(t).x}px`}),id:"menu",class:"menu"},[(0,u._)("div",null,(0,h.zw)((0,g.SU)(t).event.target.__draggable_context.element.name),1),(0,u._)("ul",null,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,g.SU)(t).menu,(e=>((0,u.wg)(),(0,u.iD)("li",{key:e.name,onClick:t=>n(e)},(0,h.zw)(e.name),9,G)))),128))])],4)):(0,u.kq)("",!0),(0,g.SU)(t).showMenuGroup?((0,u.wg)(),(0,u.iD)("div",{key:1,style:(0,h.j5)({top:`${(0,g.SU)(t).y}px`,left:`${(0,g.SU)(t).x}px`}),id:"menu-group",class:"menu"},[(0,u._)("ul",null,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,g.SU)(t).menuGroup,(e=>((0,u.wg)(),(0,u.iD)("li",{key:e.name,onClick:t=>i(e)},(0,h.zw)(e.name),9,A)))),128))])],4)):(0,u.kq)("",!0)],64))}}),Y=n(3744);const P=(0,Y.Z)(Z,[["__scopeId","data-v-d0bd111e"]]);var B=P,J=(0,u.aZ)({__name:"body-context",setup(e){const t=y();return(e,n)=>((0,u.wg)(),(0,u.iD)(u.HY,null,[(0,u.Wm)(F,{type:"todo",style:(0,h.j5)((0,g.SU)(t).info.todo.expansion?{position:"sticky",top:0,"z-index":900}:""),class:"todo-frame"},null,8,["style"]),(0,u.Wm)(F,{type:"prompt"}),(0,u.Wm)(F,{type:"promptNeg"}),(0,u.Wm)(B)],64))}});const R=J;var Q=R,X=n(5531),ee=(n(6199),n(6240),n(984));n(2034),n(502),n(627);const te=(0,m.Q_)("table",{persist:!1,state:()=>({cate:[],tableData:[]}),actions:{cerfaiSearch(e,t,n,i){const a="https://api.cerfai.com",o="/open/get_full_categories",l="/search_tags",s={keyword:n||""};i&&(s.category_id=i);const r={method:"Post",url:e?a+o:a+l,headers:{"Content-Type":"application/json"},data:JSON.stringify(e?"":s),onload:t};document.Request(r)},cerfaitagSearch(e,t){const n=y();this.cerfaiSearch(!1,(e=>{const t=JSON.parse(e.responseText);200===t.code?(this.tableData=t.data,f.z8.success(t.msg||`获取数据成功，共 ${t.data.length} 条`),n.switch.table=!0):f.z8.error(t.msg)}),e,t)},cataGet(){this.cerfaiSearch(!0,(e=>{const t=JSON.parse(e.responseText);200===t.code?(this.cate=t.data,f.z8.success(t.msg||"获取子类成功")):f.z8.error(t.msg)}))}}});var ne=(0,u.aZ)({__name:"tags-cerfai",setup(e){const t=S(),n=y(),i=te();(0,u.bv)((()=>{try{i.cataGet()}catch(e){f.z8.error("获取分类失败："+e)}}));const a=e=>{i.cerfaitagSearch("",e.toString())},l=e=>{const i=t.tagModel(e.name);i.state.editing=!1,t.todo.push(i),n.info.todo.expansion=!0};return(e,t)=>{const s=ee.E_,r=ee.F8,d=ee.Q8,p=o.Mr,m=c.OX,f=b.dq,y=X.$Y,_=X.eI,x=w.Kf;return(0,u.wg)(),(0,u.j4)(x,{"body-style":(0,g.SU)(n).switch.table?"":{display:"none"}},{header:(0,u.w5)((()=>[(0,u.Wm)(f,{align:"middle",justify:"space-between"},{default:(0,u.w5)((()=>[(0,u.Wm)(p,{style:{width:"calc(99% - 40px)","overflow-y":"hidden"}},{default:(0,u.w5)((()=>[(0,u.Wm)(d,{ellipsis:!1,"unique-opened":!0,mode:"horizontal",onSelect:a},{default:(0,u.w5)((()=>[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,g.SU)(i).cate.filter((e=>1===e.level)),(e=>((0,u.wg)(),(0,u.j4)(r,{key:e.id,index:e.id.toString()},{title:(0,u.w5)((()=>[(0,u.Uk)((0,h.zw)(e.name),1)])),default:(0,u.w5)((()=>[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,g.SU)(i).cate.filter((t=>2===t.level&&(t.id/100).toFixed(0)===(e.id/100).toFixed(0))),(e=>((0,u.wg)(),(0,u.j4)(s,{key:e.id,index:e.id.toString()},{default:(0,u.w5)((()=>[(0,u.Uk)((0,h.zw)(e.name),1)])),_:2},1032,["index"])))),128))])),_:2},1032,["index"])))),128))])),_:1})])),_:1}),(0,u.Wm)(m,{modelValue:(0,g.SU)(n).switch.table,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,g.SU)(n).switch.table=e),"inline-prompt":""},null,8,["modelValue"])])),_:1})])),default:(0,u.w5)((()=>[(0,u.Wm)(_,{data:(0,g.SU)(i).tableData,size:"small",style:{width:"100%",height:"50vh"},onRowClick:l},{default:(0,u.w5)((()=>[(0,u.Wm)(y,{label:"词条",prop:"name"}),(0,u.Wm)(y,{label:"中文名",prop:"t_name"}),(0,u.Wm)(y,{label:"NFSW",prop:"is_nsfw"}),(0,u.Wm)(y,{label:"描述",prop:"desc"}),(0,u.Wm)(y,{label:"备注",prop:"remarks"}),(0,u.Wm)(y,{label:"更新时间",prop:"update_time"}),(0,u.Wm)(y,{label:"贡献者",prop:"contributor"})])),_:1},8,["data"])])),_:1},8,["body-style"])}}});const ie=ne;var ae=ie,oe=n(4922);const le={href:"https://github.com/izumkineno/tag-model-manage",target:"_blank",title:"项目地址"},se={"aria-hidden":"true",height:"50",style:{color:"#fff","z-index":"999",position:"fixed",top:"0",border:"0",left:"0",transform:"scale(-1, 1)"},viewBox:"0 0 250 250",width:"50"},re=(0,u._)("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z",style:{fill:"var(--el-color-primary)"}},null,-1),ce=(0,u._)("path",{class:"octo-arm",d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:{"transform-origin":"130px 106px"}},null,-1),de=(0,u._)("path",{class:"octo-body",d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor"},null,-1),pe=[re,ce,de];var ue=(0,u.aZ)({__name:"App",setup(e){const t=S(),n=y(),m=te(),w=(0,g.iH)(0),_="AI画图标签管理器",b=["左键","click       启用/禁用","+ Ctr       编辑","+ Alt       权重","+ Ctr + Alt 删除","右键","click       菜单","+ Ctr       添加（回车键批量）","+ Alt       添加组","+ Ctr + Alt 切换tag模式","点击下面空白处生成tag","回车键或输入栏右边按钮搜索","点击一次搜索可能没响应，好像是API的原因","空输入时清空表格","点击表格后 待选/草稿栏 会出现对应tag"],x=(0,g.iH)(!1),v=(0,g.iH)(""),k=(0,g.iH)(),U=(0,g.iH)(),C=()=>{(0,g.SU)(U).popperRef?.delayHide?.()},M=()=>{v.value.length>0?m.cerfaitagSearch(v.value):m.tableData=[]},W=()=>{n.gradioConfig={},f.z8.success("清理配置成功")},N=()=>{const e=localStorage.getItem("main"),{promptTab:t,promptNegTab:n,todoTab:i,...a}=JSON.parse(e),o=JSON.stringify({promptTab:t,promptNegTab:n,todoTab:i});if(e){const e=new Blob([o],{type:"text/plain"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="data.txt",n.click()}},T=()=>{const e=document.createElement("input");e.type="file",e.accept="application/plain",e.onchange=e=>{try{const n=new FileReader;n.readAsText(e.target.files[0],"UTF-8"),n.onload=e=>{t.$state=JSON.parse(e.target.result),w.value++,f.z8.success("加载数据成功")}}catch(n){f.z8.error("加载数据失败："+JSON.stringify(n))}},e.click()};return(0,u.bv)((()=>{try{n.GradioConfig(!0)}catch(e){console.log(e)}})),(e,m)=>{const f=p.mi,y=d.zi,S=c.OX,z=r.EZ,E=s.Q2,O=l.$t,D=o.Mr,H=a.zd;return(0,u.wg)(),(0,u.iD)(u.HY,null,[(0,u.Wm)(y,{offset:120},{default:(0,u.w5)((()=>[(0,u.Wm)(f,{icon:(0,g.SU)(j.I8b),circle:"",type:"primary",onClick:m[0]||(m[0]=e=>x.value=!0)},null,8,["icon"])])),_:1}),(0,u.Wm)(H,{"modal-class":"black",modelValue:x.value,"onUpdate:modelValue":m[4]||(m[4]=e=>x.value=e),title:_,direction:"ltr",onContextmenu:m[5]||(m[5]=(0,i.iM)((()=>{}),["prevent"])),size:"75%"},{header:(0,u.w5)((()=>[(0,u.Wm)(E,{wrap:""},{default:(0,u.w5)((()=>[(0,u._)("a",le,[((0,u.wg)(),(0,u.iD)("svg",se,pe))]),(0,u.Wm)(f,{style:{"margin-left":"0.7rem"},type:"primary",onClick:(0,g.SU)(t).output},{default:(0,u.w5)((()=>[(0,u.Uk)("输出到webUI")])),_:1},8,["onClick"]),(0,u.Wm)(S,{modelValue:(0,g.SU)(n).switch.autoStart.active,"onUpdate:modelValue":m[1]||(m[1]=e=>(0,g.SU)(n).switch.autoStart.active=e),"active-text":(0,g.SU)(n).switch.autoStart.name,"inactive-text":(0,g.SU)(n).switch.autoStart.name,class:"ml-2","inline-prompt":""},null,8,["modelValue","active-text","inactive-text"]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(f,{ref_key:"buttonRef",ref:k},{default:(0,u.w5)((()=>[(0,u.Uk)("帮助")])),_:1})),[[(0,g.SU)(oe.Z),C]]),(0,u.Wm)(f,{onClick:m[2]||(m[2]=e=>(0,g.SU)(n).GradioConfig(!1)),onContextmenu:(0,i.iM)(W,["stop","prevent"])},{default:(0,u.w5)((()=>[(0,u.Uk)("保存生成图基础配置 ")])),_:1},8,["onContextmenu"]),(0,u.Wm)(f,{icon:(0,g.SU)(j.UWx),circle:"",type:"success",onClick:N},null,8,["icon"]),(0,u.Wm)(f,{icon:(0,g.SU)(j.gqx),circle:"",type:"warning",onClick:T},null,8,["icon"]),(0,u.Wm)(z,{modelValue:v.value,"onUpdate:modelValue":m[3]||(m[3]=e=>v.value=e),clearable:"",placeholder:"词条搜索（cerfai提供）",onKeydown:(0,i.D2)(M,["enter"])},null,8,["modelValue","onKeydown"]),(0,u.Wm)(f,{icon:(0,g.SU)(j.olm),circle:"",size:"small",type:"primary",onClick:M},null,8,["icon"])])),_:1}),(0,u.Wm)(O,{ref_key:"popoverRef",ref:U,"virtual-ref":k.value,width:200,title:"快捷键",trigger:"click","virtual-triggering":""},{default:(0,u.w5)((()=>[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(b,(e=>(0,u._)("div",{key:e},(0,h.zw)(e),1))),64))])),_:1},8,["virtual-ref"])])),default:(0,u.w5)((()=>[(0,u.Wm)(D,null,{default:(0,u.w5)((()=>[(0,u.Wm)(ae),((0,u.wg)(),(0,u.j4)(Q,{key:w.value}))])),_:1})])),_:1},8,["modelValue"])],64)}}});const ge=ue;var he=ge,me=n(3826),fe=(n(9673),n(7605));const ye=document.createElement("div");ye.id="container",document.body.appendChild(ye);const we=(0,m.WB)();we.use(fe.Z),(0,i.ri)(he).use(me.Z).use(we).mount("#container")}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,i,a,o){if(!i){var l=1/0;for(d=0;d<e.length;d++){i=e[d][0],a=e[d][1],o=e[d][2];for(var s=!0,r=0;r<i.length;r++)(!1&o||l>=o)&&Object.keys(n.O).every((function(e){return n.O[e](i[r])}))?i.splice(r--,1):(s=!1,o<l&&(l=o));if(s){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[i,a,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var a,o,l=i[0],s=i[1],r=i[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(r)var d=r(n)}for(t&&t(i);c<l.length;c++)o=l[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(d)},i=self["webpackChunknoval_tag_model_manage"]=self["webpackChunknoval_tag_model_manage"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(3363)}));i=n.O(i)})();